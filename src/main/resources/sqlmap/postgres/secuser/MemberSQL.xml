<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<!-- namespace=com.shoppingmall.admin.repository.MemberMapper -->
<mapper namespace="NonSocialMemberSQL"> 

	<select id="MemberSQL.countMemberByLoginId" parameterType="dataMap" resultType="int">
		/*아이디 중복검사: SQL ID: MemberSQL.countMemberByLoginId*/
		<![CDATA[
			SELECT
				COUNT(*)
			FROM
				member
			WHERE login_id = #{login_id}
		]]>
		
	</select>
	<select id="MemberSQL.countMemberByName" resultType="int" parameterType="dataMap">
		/*아이디 중복검사: SQL ID: MemberSQL.countMemberByName*/
		<![CDATA[
			SELECT
				COUNT(*)
			FROM
				member
			WHERE user_name = #{user_name}
		]]>
		
	</select>
	<select id="MemberSQL.getOneMemberByUserId"  parameterType="dataMap" resultType="dataMap" >
        /*이름에 따른 회원찾기 : MemberSQL.getOneMemberByName */
        SELECT auth_id, login_id, email, password, user_name, authority
        FROM member
        WHERE login_id = #{login_id}
    </select>
    <select id="MemberSQL.getOneMemberByEmail" parameterType="dataMap" resultType="dataMap">
    	/*email로 회원 찾기 */
    	SELECT * 
    	FROM member
    	WHERE email = #{email}
    </select>
    
    <select id="MemberSQL.searchForUsers"  parameterType="dataMap" resultType="dataMap" >
        /*admin이 회원 검색: MemberSQL.searchForUsers" */
        
        SELECT auth_id, login_id, email, user_name, authority
        FROM member
        WHERE login_id LIKE CONCAT('%', #{keyword}, '%') 
           OR email LIKE CONCAT('%', #{keyword}, '%') 
           OR user_name LIKE CONCAT('%', #{keyword}, '%') 
    </select>
    
	<insert id="MemberSQL.signUpFor" parameterType="dataMap" >
	/* 회원 가입: MemberSQL.signUpFor*/
		INSERT INTO member
		(
			login_type,
			login_id,
			email,
			password,
			email_verified,
			locked,
			authority,
			address,
			user_name,
			u_ph
		)
		VALUES
		(
		   #{login_type},
		   #{login_id},
		   #{email},
		   #{password},
		   #{email_verified},
		   #{locked},
		   #{authority},
		   #{address},
		   #{user_name},
		   #{u_ph}
		)
		ON CONFLICT(login_id)
		DO NOTHING;
		
	</insert>
	
	
	
</mapper>